# DATA‑JSON.md – Reference for the SPA build artefacts  *(build v0.6.2 · 2025‑04‑18)*

> These four static files are generated by `scripts/build_data.py`  
> and shipped in **`dist/data/`**. The React SPA fetches them at runtime. citeturn6file1

| File | Format | Typical size \* | Records | Purpose |
|------|--------|-----------------|---------|---------|
| **`entries.ndjson`** | NDJSON (1 object / line) | **≈ 6.9 MB** (gzip ≈ 460 kB) | 20 576 lines | Text‑centric master dataset for search & entry view. |
| **`index.json`** | Lunr v2 serialisation | ≈ 13.7 MB (gzip ≈ 1.1 MB) | 20 576 docs | In‑browser full‑text index. |
| **`graph.json`** | plain JSON | **≈ 210 kB** (gzip ≈ 16 kB) | 20 576 nodes / **≈ 12 300** edges | Lemma‑variant‑xref network. |
| **`symbols.json`** | JSON array | ≈ 23 kB (gzip ≈ 7 kB) | 294 glyphs | Symbol gallery: glyph → entry IDs & counts. |

\* Typical sizes of the uncompressed files produced on 18 Apr 2025; gzip sizes refer to the production bundle.

---

## 1 `entries.ndjson`

One self‑contained JSON object per line – ideal for streaming or CLI processing (`jq`, `awk`).  
Every field is UTF‑8; no control characters.

```jsonc
{
  "id": "sommerhoff1701-Calcaria~dup1",   // xml:id or @n; ~dup# if @n repeats
  "source": "sommerhoff",                 // "ruland" | "sommerhoff"
  "lemma": "Calcaria",
  "lemma_norm": "calcaria",
  "variants": "kalk kalch",               // space‑joined variant tokens
  "translations": "",                     // German glosses (may be empty)
  "definition": "…",                      // full <def> text
  "symbols": ["lime"],                    // glyph ids from <g ref="#…">
  "glyphs": "🜛",                          // printable symbols (concat)
  "page": "31",                           // first preceding <pb>@n
  "facs": "#img_0031",                    // matching facsimile zone id
  "section": "lat-de",                    // Sommerhoff half; null for Ruland
  "translations_lang": "",                // ISO 639‑1 (de)
  "definition_lang": "la",                // ISO 639‑1 (la)
  "xrefs": ["Æs_d"]                       // explicit <ref>/<xr> targets
}
```

### Field glossary

| Field | Type | Notes |
|-------|------|-------|
| `id` | string | Prefer `xml:id`; else `@n`; duplicate @n → `~dup1`, `~dup2` … |
| `source` | string | Originating TEI file (`ruland` / `sommerhoff`). |
| `lemma`, `lemma_norm` | string | Original headword and normalised ASCII form. |
| `variants` | string | Space‑separated tokens from all `<form type='variant'>`. |
| `translations` | string | Concatenated German `<cit type='translation'>`. |
| `definition` | string | Concatenated `<def>` bodies. |
| `symbols` | array\<string> | Glyph ids referenced in the entry (may be empty). |
| `glyphs` | string | Printable Unicode for quick preview/filter. |
| `page`, `facs` | string | Pagination & facsimile link from the first preceding `<pb>`. |
| `section` | `"lat-de"`\|`"de-lat"`\|`"unknown"`\|`null` | Sommerhoff half. |
| `translations_lang`, `definition_lang` | string | ISO 639‑1 language tags. |
| `xrefs` | array\<string> | Targets from `<ref>` / `<xr>` and “vide …” heuristics. |

---

## 2 `index.json`

A **Lunr v2** inverted index serialised for the browser – treated as an opaque blob:

```js
import lunr from "lunr";
const idx = lunr.Index.load(await (await fetch("/data/index.json")).json());
const hits = idx.search("calcaria");
```

Indexed fields: `lemma`, `lemma_norm`, `variants`, `translations`, `definition`.  
Reference field: `id`.

---

## 3 `graph.json`

Topology for synonym/cross‑reference exploration (e.g. export to Gephi).

```jsonc
{
  "v": "2025‑04‑18",
  "nodes": [
    { "id": "ruland:57", "label": "Aqua fortis", "source": "ruland", … }
  ],
  "edges": [
    { "source": "ruland:57", "target": "aqua fortis", "type": "variant" },
    { "source": "sommerhoff:8935", "target": "ruland:57", "type": "xref" }
  ]
}
```

### Edge semantics

| `type` | Meaning |
|-------|---------|
| `variant` | Node → normalised variant token (unidirectional). |
| `xref` | Explicit `<ref>` / `<xr>` or “vide …” reference (source → target id). |

*Every `source`/`target` exists in `nodes` or is a plain string token.*

---

## 4 `symbols.json`

Metadata powering the **Symbols** explorer.

```jsonc
[
  {
    "id": "lime",
    "glyph": "🜛",
    "entries": ["sommerhoff1701-Calcaria~dup1", "sommerhoff1701-Calcaria"],
    "count": 2
  },
  …
]
```

* Ordered descending by `count` → front‑end can render directly.  
* If `glyph` is empty, show a ▢ placeholder or sprite fallback.

---

## 5 Cross‑file relationships

* `entries.ndjson.symbols` ↔ **`symbols.json.id`** (1 : *).  
* `graph.json.nodes.id` is always present in `entries.ndjson.id`.  
* `index.json` uses the same `id` keys, so a Lunr hit resolves directly to an entry.

---